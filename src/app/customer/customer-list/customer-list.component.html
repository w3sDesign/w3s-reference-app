<!-- Initial version based on Metronic 5.5.5. x-->

<div class="mat-elevation-z8" style="margin:30px;">






  <!-- ############################################################ -->
  <!-- Collapsible Expansion Panel for Search Filters-->
  <!-- ############################################################ -->

  <mat-expansion-panel>

    <!-- ########################################################## -->
    <!-- Expansion Header: Showing active filters -->
    <!-- ########################################################## -->

    <mat-expansion-panel-header>

      <mat-panel-title>
        Search Filters
        <mat-icon color="primary">info</mat-icon>
      </mat-panel-title>

      <mat-panel-description>
        Currently 2 filters active: Status, Type
      </mat-panel-description>

    </mat-expansion-panel-header>


    <!-- ########################################################## -->
    <!-- Expansion Content: Customer Filter Template -->
    <!-- ########################################################## -->



    <!-- ========================================================== -->
    <!-- Selecting a filter template -->
    <!-- ========================================================== -->

    <mat-form-field>
      <mat-select [(value)]="selectedFilterTemplateName" (selectionChange)="renderFilterTemplate(selectedFilterTemplateName)">

        <!-- <mat-option value="standard">Standard</mat-option> -->
        <mat-option *ngFor="let name of filterTemplateNames" value="{{name}}">{{name}}</mat-option>
      </mat-select>
      <mat-hint align="start">
        Select Filter Template
      </mat-hint>
    </mat-form-field>

    <!-- <mat-form-field appearance="fill">
      <mat-label>Country</mat-label>
      <mat-select formControlName="country">
        <mat-option *ngFor="let country of countries" value="{{country.name}}">{{country.name}}</mat-option>
      </mat-select>
      <mat-error>Country is required.</mat-error>
    </mat-form-field> -->


    <!-- ========================================================== -->
    <!-- Search input field for searching in all customer fields -->
    <!-- ========================================================== -->

    <mat-form-field style="padding-bottom: 16px">
      <input matInput #searchInput placeholder="Search">
      <mat-hint align="start">
        Search in all fields
      </mat-hint>
    </mat-form-field>



    <!-- ========================================================== -->
    <!-- Filter template dynamic form. -->
    <!-- ========================================================== -->

    <w3s-dynamic-form *ngIf="filterTemplateQuestions" [questions]="filterTemplateQuestions" (formSubmit)="onFilterTemplateFormSubmit($event)">

    </w3s-dynamic-form>

    <!-- ========================================================== -->



    <!-- ========================================================== -->
    <!-- Filter template buttons -->
    <!-- ========================================================== -->

    <div id="filterButtons">

      <!-- <button mat-raised-button matTooltip="Start searching with the provided filters." (click)="searchCustomers(dynFormComponent.form.value)">
        Search
      </button> -->

      <button mat-raised-button matTooltip="Save current filters as new template." (click)="createFilterTemplate(dynFormComponent.form.getRawValue())">
        Save as
      </button>

      <button mat-raised-button matTooltip="Save current filters (= update current template)." (click)="updateFilterTemplate(dynFormComponent.form.getRawValue())">
        Save
      </button>

      <button mat-raised-button matTooltip="Clear all filters." (click)="dynFormComponent.form.reset()">
        Clear all
      </button>

      <button mat-raised-button matTooltip="Add new and/or remove existing filters." (click)="TODO()">
        Settings
      </button>

    </div>


    <br>***filterTemplates:<br>           {{filterTemplates | json}}
    <br>***filterTemplateFormValue:<br>   {{filterTemplateFormValue | json}}
    <br>***selectedFilterTemplateName<br> {{selectedFilterTemplateName}}


    <!-- ========================================================== -->
    <!-- OLD
      <mat-form-field>
        <input matInput [(ngModel)]="filterById" (change)="loadCustomers()">
        <mat-error></mat-error>
        <mat-hint align="start">
          Id
        </mat-hint>
      </mat-form-field>

      <mat-form-field>
        <input matInput [(ngModel)]="filterByName" (change)="loadCustomers()">
        <mat-error></mat-error>
        <mat-hint align="start">
          Name
        </mat-hint>
      </mat-form-field>

      <mat-form-field>
        <mat-select [(value)]="filterByStatus" (selectionChange)="loadCustomers()">
          <mat-option value=""></mat-option>
          <mat-option value="0">Suspended</mat-option>
          <mat-option value="1">Active</mat-option>
          <mat-option value="Pending">Pending</mat-option>
        </mat-select>
        <mat-hint align="start">
          Customer Status
        </mat-hint>
      </mat-form-field>
     -->


  </mat-expansion-panel>

  <!-- Expansion panel end -->






  <!-- ############################################################ -->
  <!-- CRUD - Create, Update, and Delete Buttons -->
  <!-- ############################################################ -->

  <!-- <mat-action-row #crudButtons style="align-items: center; font-size:14px;"> -->
  <div id="crudButtons" #crudButtons>

    <div class="special-font">
      {{dataSource.totalNumberOfItems | async}} customers selected.
    </div>

    <div class="push-right">
      <button mat-raised-button color="primary" matTooltip="Create new customers" (click)="createCustomer()">
        Create
      </button>
    </div>

    <button mat-raised-button color="primary" matTooltip="Update selected customers" (click)="updateCustomer()">
      Update
    </button>

    <button mat-raised-button color="primary" matTooltip="Delete selected customers" (click)="deleteCustomers()">
      Delete
    </button>

    <button mat-raised-button matTooltip="Select which columns to display" (click)="TODO()">
      Settings
    </button>

  </div>
  <!-- </mat-action-row> -->
  <!-- End of Create/Update/Delete -->

  <mat-divider></mat-divider>


  <!-- ############################################################ -->
  <!-- Material Data Table -->
  <!-- ############################################################ -->

  <table mat-table #table matSort [dataSource]="dataSource">

    <!-- Selection/Checkbox column definition -->
    <ng-container matColumnDef="select">
      <th mat-header-cell *matHeaderCellDef>
        <mat-checkbox (change)="$event ? masterToggle() : null" [checked]="selection.hasValue() && isAllSelected()" [indeterminate]="selection.hasValue() && !isAllSelected()">
        </mat-checkbox>
      </th>
      <td mat-cell *matCellDef="let row">
        <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? selection.toggle(row) : null" [checked]="selection.isSelected(row)">
        </mat-checkbox>
      </td>
    </ng-container>

    <!-- All other column definitions -->
    <ng-container [matColumnDef]="column" *ngFor="let column of columns">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>{{column | titlecase}}</th>
      <td mat-cell *matCellDef="let element">{{element[column]}}</td>
    </ng-container>

    <!-- Row definition -->
    <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>

    <!--
    <tr mat-row *matRowDef="let row; columns: columnsToDisplay;" (click)="selection.toggle(row)">
    -->
    <tr mat-row *matRowDef="let row; columns: columnsToDisplay;" (click)="onSelect(row)">

    </tr>

  </table>
  <!-- End data table -->


  <!-- ############################################################ -->
  <!-- Bottom row - spinner and paginator -->
  <!-- ############################################################ -->
  <!-- <div style="display:flex; justify-content:flex-end;"> -->

  <mat-action-row style="align-items: center">
    <mat-spinner [diameter]="20" *ngIf="dataSource.isLoading | async">
    </mat-spinner>

    <mat-paginator [pageSize]="10" [pageSizeOptions]="[5, 10, 25, 50, 100, 250, 500]" [length]="dataSource.totalNumberOfItems | async" [showFirstLastButtons]="true">
    </mat-paginator>
  </mat-action-row>
  <!-- End bottom row -->


</div>
