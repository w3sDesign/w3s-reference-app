<div class="w3s-list-component mat-elevation-z8">


  <!-- ############################################################ -->
  <!-- Filters -->
  <!-- ############################################################ -->

  <mat-expansion-panel id="filterContainer">

    <!-- ########################################################## -->
    <!-- Filter header  -->
    <!-- ########################################################## -->

    <mat-expansion-panel-header [collapsedHeight]="'58px'" [expandedHeight]="'58px'">


      <mat-panel-title>
        Search Customers
        <!-- <mat-icon color="primary">info</mat-icon> -->
      </mat-panel-title>

      <mat-panel-description>
        Currently 2 filters active: Status, Type
      </mat-panel-description>

    </mat-expansion-panel-header>


    <!-- ########################################################## -->
    <!-- Filter template content  -->
    <!-- ########################################################## -->




    <div id="filterButtons">


      <!-- ========================================================== -->
      <!-- Selecting a filter template -->
      <!-- ========================================================== -->

      <mat-form-field>

        <mat-select [(value)]="selectedFilterTemplateName" (selectionChange)="renderFilterTemplateForm(selectedFilterTemplateName)">

          <!-- <mat-option value="standard">Standard</mat-option> -->
          <mat-option *ngFor="let name of filterTemplateNames" value="{{name}}">{{name}}</mat-option>
        </mat-select>

        <mat-hint align="start">
          Select Filter Template
        </mat-hint>

      </mat-form-field>

      <!-- <mat-form-field appearance="fill">
      <mat-label>Country</mat-label>
      <mat-select formControlName="country">
        <mat-option *ngFor="let country of countries" value="{{country.name}}">{{country.name}}</mat-option>
      </mat-select>
      <mat-error>Country is required.</mat-error>
    </mat-form-field> -->


      <!-- ========================================================== -->
      <!-- Search input field for searching in all customer fields -->
      <!-- ========================================================== -->

      <mat-form-field style="padding-bottom: 16px">
        <input matInput #searchInput placeholder="Search">
        <mat-hint align="start">
          Search in all fields
        </mat-hint>
      </mat-form-field>




      <!-- ========================================================== -->
      <!-- Filter template buttons -->
      <!-- ========================================================== -->


      <div class="push-right">

        <button mat-raised-button matTooltip="Start searching customers by applying the provided filters." (click)="searchCustomers()">
          Search
        </button>

      </div>


      <button mat-raised-button matTooltip="Clear all filters." (click)="filterTemplateForm.form.reset()">
        Clear
      </button>

      <button mat-raised-button matTooltip="Save the current filter template." (click)="updateFilterTemplate(filterTemplateForm.form.getRawValue())">
        Save
      </button>

      <button mat-raised-button matTooltip="Save the current filter template as new template." (click)="createFilterTemplate(filterTemplateForm.form.getRawValue())">
        Save as
      </button>


      <button mat-raised-button matTooltip="Select (add/remove) filters." (click)="filterDrawerRef.toggle()">
        Settings
      </button>

    </div>









    <!-- ############################################################## -->
    <!-- Filter entry -->
    <!-- ############################################################## -->

    <mat-drawer-container>


      <!-- ############################################################ -->
      <!-- Right drawer for selecting the filters to display -->
      <!-- ############################################################ -->

      <mat-drawer id="filterDrawer" #filterDrawerRef position="end" mode="side" [opened]="'false'" class="mat-elevation-z8">






        <table mat-table #selectingFiltersTable [dataSource]="availableFilters">

          <ng-container [matColumnDef]="column" *ngFor="let column of ['select3', 'name']; let i = index" matTooltip="Select which filters to display">

            <!-- Selection/Checkbox column/cell definition -->
            <ng-container *ngIf="column === 'select3'">
              <th mat-header-cell *matHeaderCellDef>
                <mat-checkbox (change)="$event ? masterToggle3() : null; setFiltersToDisplay()" [checked]="filterSelection.hasValue() && isAllSelected3()" [indeterminate]="filterSelection.hasValue() && !isAllSelected3()">
                </mat-checkbox>
              </th>
              <!-- row from dataSource -->
              <td mat-cell *matCellDef="let row">
                <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? filterSelection.toggle(row) : null; setFiltersToDisplay()" [checked]="filterSelection.isSelected(row)">
                </mat-checkbox>
              </td>
            </ng-container>

            <!-- All other column/cell definitions -->
            <ng-container *ngIf="column !== 'select3'">
              <th mat-header-cell *matHeaderCellDef>
                Select Filters

                <!-- <button mat-button style="color:inherit; margin-left:20px" color="accent" matTooltip="Close" (click)="filterDrawerRef.toggle()"> -->
                <!-- Close -->
                <!-- </button> -->

              </th>
              <td mat-cell *matCellDef="let row">{{row | titlecase}}</td>
            </ng-container>

          </ng-container>


          <!-- Row definitions -->
          <tr mat-header-row *matHeaderRowDef="['select3', 'name']"></tr>
          <tr mat-row *matRowDef="let row; columns: ['select3', 'name']" (click)="filterSelection.toggle(row)"></tr>

        </table>

      </mat-drawer>




      <!-- ############################################################ -->
      <!-- Filter template dynamic form. -->
      <!-- ############################################################ -->


      <mat-drawer-content id="filterTemplateForm">



        <div *ngIf="showTestValues" class="showTestValues">

          <br>##########filterTemplates:<br> {{filterTemplates | json}}
          <br>##########selectedFilterTemplateName: {{selectedFilterTemplateName}}
          <br>##########filterTemplateFormValue:<br> {{filterTemplateFormValue | json}}
          <!-- <br>##########filterTemplateForm.form.value:<br> {{filterTemplateForm.form.value | json}} -->

          <br>##########filterTemplateFormOptions: {{filterTemplateFormOptions | json}}

          <br>##########filterTemplateQuestions:<br> {{filterTemplateQuestions | json}}



          <br>##########?availableFilters:<br> {{availableFilters | json}}

          <br>##########?filtersToDisplay:<br> {{filtersToDisplay | json}}


        </div>


        <!-- ========================================================== -->
        <!-- Generating the customer filter template dynamic form. -->
        <!-- ========================================================== -->

        <w3s-dynamic-form #filterTemplateForm *ngIf="filterTemplateQuestions" [questions]="filterTemplateQuestions" [options]="filterTemplateFormOptions" (formSubmit)="onFilterTemplateFormSubmit($event)">

        </w3s-dynamic-form>


        <div *ngIf="showTestValues" class="showTestValues">

          <br>##########filterTemplateFormValue:<br> {{filterTemplateFormValue | json}}

        </div>


        <!-- ========================================================== -->
        <!-- OLD
      <mat-form-field>
        <input matInput [(ngModel)]="filterById" (change)="getCustomers()">
        <mat-error></mat-error>
        <mat-hint align="start">
          Id
        </mat-hint>
      </mat-form-field>

      <mat-form-field>
        <input matInput [(ngModel)]="filterByName" (change)="getCustomers()">
        <mat-error></mat-error>
        <mat-hint align="start">
          Name
        </mat-hint>
      </mat-form-field>

      <mat-form-field>
        <mat-select [(value)]="filterByStatus" (selectionChange)="getCustomers()">
          <mat-option value=""></mat-option>
          <mat-option value="0">Suspended</mat-option>
          <mat-option value="1">Active</mat-option>
          <mat-option value="Pending">Pending</mat-option>
        </mat-select>
        <mat-hint align="start">
          Customer Status
        </mat-hint>
      </mat-form-field>
     -->


      </mat-drawer-content>

    </mat-drawer-container>


  </mat-expansion-panel>
  <!-- The filter expansion panel end -->



  <!-- ############################################################ -->
  <!-- Main CRUD Create/Update/Delete Buttons -->
  <!-- ############################################################ -->

  <!-- <mat-action-row #crudButtons style="align-items: center; font-size:14px;"> -->
  <div id="crudButtons" #crudButtons>

    <div class="special-font">
      {{dataSource.totalNumberOfItems | async}} customers selected.
    </div>

    <div class="push-right">
      <button mat-raised-button color="primary" matTooltip="Create new customers" (click)="createCustomer()">
        Create
      </button>
    </div>

    <button mat-raised-button color="primary" matTooltip="Update selected customers" (click)="updateCustomer()">
      Update
    </button>

    <button mat-raised-button color="primary" matTooltip="Delete selected customers" (click)="deleteCustomers()">
      Delete
    </button>

    <button mat-raised-button matTooltip="Add/Remove columns" (click)="columnDrawerRef.toggle()">
      Settings
    </button>

  </div>
  <!-- End of main CRUD Buttons -->


  <mat-divider></mat-divider>



  <!-- ############################################################## -->
  <!-- Main content -->
  <!-- ############################################################## -->

  <mat-drawer-container id="listContainer">

    <!-- ############################################################ -->
    <!-- Right drawer for selecting the columns to display -->
    <!-- ############################################################ -->

    <mat-drawer id="columnDrawer" #columnDrawerRef position="end" mode="side" [opened]="'false'" class="mat-elevation-z8">

      <table mat-table id="selectingColumnsTable" #selectingColumnsTable [dataSource]="availableColumns">

        <ng-container [matColumnDef]="column" *ngFor="let column of ['select2', 'name']; let i = index" matTooltip="Select which columns to display">

          <!-- Selection/Checkbox column/cell definition -->
          <ng-container *ngIf="column === 'select2'">
            <th mat-header-cell *matHeaderCellDef>
              <mat-checkbox (change)="$event ? masterToggle2() : null; setColumnsToDisplay()" [checked]="columnSelection.hasValue() && isAllSelected2()" [indeterminate]="columnSelection.hasValue() && !isAllSelected2()">
              </mat-checkbox>
            </th>
            <!-- row from dataSource -->
            <td mat-cell *matCellDef="let row">
              <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? columnSelection.toggle(row) : null; setColumnsToDisplay()" [checked]="columnSelection.isSelected(row)">
              </mat-checkbox>
            </td>
          </ng-container>

          <!-- All other column/cell definitions -->
          <ng-container *ngIf="column !== 'select2'">
            <th mat-header-cell *matHeaderCellDef>
              Select Columns
            </th>
            <td mat-cell *matCellDef="let row">{{row | titlecase}}</td>
          </ng-container>

        </ng-container>


        <!-- Row definitions -->
        <tr mat-header-row *matHeaderRowDef="['select2', 'name']"></tr>
        <tr mat-row *matRowDef="let row; columns: ['select2', 'name']" (click)="columnSelection.toggle(row)"></tr>

      </table>

    </mat-drawer>


    <!-- ############################################################ -->
    <!-- Main data table with paginator  -->
    <!-- ############################################################ -->

    <mat-drawer-content>

      <div *ngIf="showTestValues" class="showTestValues">
        <br>##########availableColumns: {{availableColumns | json}}
        <br>##########columnsToDisplay: {{columnsToDisplay | json}}
      </div>


      <!-- ############################################################ -->
      <!-- Main data table -->
      <!-- ############################################################ -->

      <table mat-table id="mainDataTable" #table matSort cdkDropListGroup [cdkDropListGroupDisabled]="'true'" [dataSource]="dataSource">

        <ng-container [matColumnDef]="column" *ngFor="let column of availableColumns; let i = index">

          <!-- Selection/Checkbox column/cell definition -->
          <ng-container *ngIf="column === 'select'">
            <th mat-header-cell *matHeaderCellDef>
              <mat-checkbox (change)="$event ? masterToggle() : null" [checked]="selection.hasValue() && isAllSelected()" [indeterminate]="selection.hasValue() && !isAllSelected()">
              </mat-checkbox>
            </th>
            <td mat-cell *matCellDef="let row">
              <!-- row from dataSource -->
              <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? selection.toggle(row) : null" [checked]="selection.isSelected(row)">
              </mat-checkbox>
            </td>
          </ng-container>

          <!-- All other column/cell definitions -->
          <ng-container *ngIf="column !== 'select'">
            <th mat-header-cell *matHeaderCellDef mat-sort-header cdkDropList cdkDropListLockAxis="x" cdkDropListOrientation="horizontal" (cdkDropListDropped)="dropListDropped($event, i)" cdkDrag (cdkDragStarted)="dragStarted($event, i)" [cdkDragData]="{name: column, columnIndex: i}">
              {{column | titlecase}}
              <!-- <div class="example-handle" cdkDragHandle></div> -->
            </th>
            <td mat-cell *matCellDef="let row">{{row[column]}}</td>
          </ng-container>

        </ng-container>


        <!-- Row definitions -->
        <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
        <tr mat-row *matRowDef="let row; columns: columnsToDisplay;" (click)="goToCustomerDetail(row)">
        </tr>
        <!--
      <tr mat-row *matRowDef="let row; columns: columnsToDisplay;"
          (click)="selection.toggle(row)">
      -->

      </table>
      <!-- End main data table -->


      <!-- ############################################################ -->
      <!-- Bottom row with spinner and paginator -->
      <!-- ############################################################ -->
      <!-- <div style="display:flex; justify-content:flex-end;"> -->

      <mat-action-row style="align-items: center">

        <mat-spinner [diameter]="20" *ngIf="dataSource.isLoading | async">
        </mat-spinner>

        <mat-paginator [pageSize]="10" [pageSizeOptions]="[5, 10, 25, 50, 100, 250, 500]" [length]="dataSource.totalNumberOfItems | async" [showFirstLastButtons]="true">
        </mat-paginator>

      </mat-action-row>


    </mat-drawer-content>


  </mat-drawer-container>


</div>
<!-- The end of .w3s-list-component -->
