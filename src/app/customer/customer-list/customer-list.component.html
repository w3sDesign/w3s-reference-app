<div class="w3s-list-component mat-elevation-z8">


  <!-- ############################################################ -->
  <!-- ############################################################ -->
  <!-- (1) Filter Section -->
  <!-- ############################################################ -->
  <!-- ############################################################ -->


  <w3s-customer-filter-template (queryParamsChange)="getCustomers($event)">

  </w3s-customer-filter-template>







  <!-- ############################################################## -->
  <!-- ############################################################## -->
  <!-- (2) List Section -->
  <!-- ############################################################## -->
  <!-- ############################################################## -->


  <!-- ############################################################ -->
  <!-- Create/Update/Delete customers buttons -->
  <!-- ############################################################ -->

  <!-- <mat-action-row #crudButtons style="align-items: center; font-size:14px;"> -->
  <div id="crudButtons" #crudButtons>

    <div class="special-font">
      {{dataSource.totalNumberOfItems | async}} customers selected.
    </div>


    <div class="push-right">
      <button mat-raised-button color="primary" matTooltip="Create new customers" (click)="createCustomer()">
        Create
      </button>
    </div>

    <button mat-raised-button color="primary" matTooltip="Update selected customers" (click)="updateCustomer()">
      Update
    </button>

    <button mat-raised-button color="primary" matTooltip="Delete selected customers" (click)="deleteCustomers()">
      Delete
    </button>

    <button mat-raised-button matTooltip="Add/Remove columns" (click)="columnDrawerRef.toggle()">
      Settings
    </button>

  </div>
  <!-- End of main CRUD Buttons -->


  <mat-divider></mat-divider>




  <mat-drawer-container>

    <!-- ############################################################ -->
    <!-- Select columns -->
    <!-- ############################################################ -->
    <!-- Right drawer for selecting the columns to display -->

    <mat-drawer #columnDrawerRef position="end" mode="side" [opened]="'false'" class="mat-elevation-z8">

      <table mat-table #selectingColumnsTable [dataSource]="availableColumns">

        <ng-container [matColumnDef]="column" *ngFor="let column of ['select2', 'name']; let i = index" matTooltip="Select which columns to display">

          <!-- Selection/Checkbox column/cell definition -->
          <ng-container *ngIf="column === 'select2'">
            <th mat-header-cell *matHeaderCellDef>
              <mat-checkbox (change)="$event ? masterToggle2() : null; setColumnsToDisplay()" [checked]="columnSelection.hasValue() && allColumnsSelected()" [indeterminate]="columnSelection.hasValue() && !allColumnsSelected()">
              </mat-checkbox>
            </th>
            <!-- row from dataSource -->
            <td mat-cell *matCellDef="let row">
              <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? columnSelection.toggle(row) : null; setColumnsToDisplay()" [checked]="columnSelection.isSelected(row)">
              </mat-checkbox>
            </td>
          </ng-container>

          <!-- All other column/cell definitions -->
          <ng-container *ngIf="column !== 'select2'">
            <th mat-header-cell *matHeaderCellDef>
              Select Columns
            </th>
            <td mat-cell *matCellDef="let row">{{row | titlecase}}</td>
          </ng-container>

        </ng-container>


        <!-- Row definitions -->
        <tr mat-header-row *matHeaderRowDef="['select2', 'name']"></tr>
        <tr mat-row *matRowDef="let row; columns: ['select2', 'name']" (click)="columnSelection.toggle(row)"></tr>

      </table>

    </mat-drawer>


    <mat-drawer-content>

      <div *ngIf="showTestValues" class="showTestValues">
        <br>########## availableColumns = <br> {{availableColumns | json}}
        <br>########## columnsToDisplay = <br> {{columnsToDisplay | json}}
      </div>


      <!-- ############################################################ -->
      <!-- Main customer data table -->
      <!-- ############################################################ -->

      <table mat-table #table matSort cdkDropListGroup [cdkDropListGroupDisabled]="'true'" [dataSource]="dataSource">

        <ng-container [matColumnDef]="column" *ngFor="let column of availableColumns; let i = index">

          <!-- Selection/Checkbox column/cell definition -->
          <ng-container *ngIf="column === 'select'">
            <th mat-header-cell *matHeaderCellDef>
              <mat-checkbox (change)="$event ? masterToggle() : null" [checked]="rowSelection.hasValue() && allRowsSelected()" [indeterminate]="rowSelection.hasValue() && !allRowsSelected()">
              </mat-checkbox>
            </th>
            <td mat-cell *matCellDef="let row">
              <!-- row from dataSource -->
              <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? rowSelection.toggle(row) : null" [checked]="rowSelection.isSelected(row)">
              </mat-checkbox>
            </td>
          </ng-container>

          <!-- All other column/cell definitions -->
          <ng-container *ngIf="column !== 'select'">
            <th mat-header-cell *matHeaderCellDef mat-sort-header cdkDropList cdkDropListLockAxis="x" cdkDropListOrientation="horizontal" (cdkDropListDropped)="dropListDropped($event, i)" cdkDrag (cdkDragStarted)="dragStarted($event, i)" [cdkDragData]="{name: column, columnIndex: i}">
              {{column | titlecase}}
              <!-- <div class="example-handle" cdkDragHandle></div> -->
            </th>
            <td mat-cell *matCellDef="let row">{{row[column]}}</td>
          </ng-container>

        </ng-container>


        <!-- Row definitions -->
        <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
        <tr mat-row *matRowDef="let row; columns: columnsToDisplay;" (click)="goToCustomerDetail(row)">
        </tr>
        <!--
      <tr mat-row *matRowDef="let row; columns: columnsToDisplay;"
          (click)="rowSelection.toggle(row)">
      -->

      </table>


      <!-- ############################################################ -->
      <!-- Spinner and paginator -->
      <!-- ############################################################ -->
      <!-- <div style="display:flex; justify-content:flex-end;"> -->

      <mat-action-row style="align-items: center">

        <mat-spinner [diameter]="20" *ngIf="dataSource.isLoading | async">
        </mat-spinner>

        <mat-paginator [pageSize]="10" [pageSizeOptions]="[5, 10, 25, 50, 100, 250, 500]" [length]="dataSource.totalNumberOfItems | async" [showFirstLastButtons]="true">
        </mat-paginator>

      </mat-action-row>


    </mat-drawer-content>


  </mat-drawer-container>


</div>
<!-- .w3s-list-component -->
